<body>
    <head>
        <script src="http://192.168.0.156:4200/dist/atrys-sdk.js" type="module"></script>
        <script type="module">

            try {
                const mit = new MIT('LOCAL', '398475934759375937539875398475m9753j93nhjhkm');
        
                const integrationClientIdentificator = 'zurich';
                mit.sharedData.integrationClientIdentificator = integrationClientIdentificator

                console.log('MIT', mit);

                const session = await mit.session()
                console.log('SESSION', session);

                const req = await mit.normalizeModel({
                    from: integrationClientIdentificator,
                    payload: {
                        "GeolocationData":{
                            "Country":"AR",
                            "State":"CAPITAL FEDERAL",
                            "City":"CAPITAL FEDERAL",
                            "Latitude":"-34.64424e",
                            "Longitude":"-58.55662",
                            "Address":"Calle prueba 1234",
                            "Extra":"Piso 6"
                        },
                        "BeneficiaryData":{
                            "IdType":"DNI",
                            "IdNumber":"33182287",
                            "FirstName":"GONZALO EZEQUIEL",
                            "LastName":"DAUD",
                            "IntPhoneCode":"54",
                            "PhoneNumber":"1161711401",
                            "Email":"patient-sd2k@yopmail.com",
                            "DateOfBirth":"1987-07-22",
                            "Language":"ES"
                        },
                        "CaseData":{
                            "CaseId":"1-C6A0OUU",
                            "CaseNum":"1-26501013462"
                        }
                    }    
                })

                console.log('patient normalized', req.data);

                const newPatient = await mit.createPatient(req.data)
                console.log('patient created', newPatient.data);

                const appointmentPayload = await mit.getAppointmentIdByExternalId()
                console.log("Get appointment by caseId OK", appointmentPayload);

/*
                const login = await mit.login()
                console.log('login', login.data);

                const inmediate = await mit.reserveInmediateAppointment()
                console.log('inmediate reserve', inmediate.data);

                const consolidate = await mit.consolidateInmediateAppointment([])
                console.log('inmediate consolidate', consolidate.data);

                let url = consolidate.data.payload.paymentUrl
                window.open(url)


            const listProfessionals = await mit.listProfessionals()
            console.log('list profesionals', listProfessionals.data);

            // medico
            const specialties = await mit.listSpecialties('5f35e707127b082ccd516c1b')
            console.log('list specialties', specialties.data);

            // medico general
            const blocks = await mit.listBlocks({
                date: {
                    month: 8,
                    year: 2021,
                    day: 19
                },
                specailtyId: "6001fd6deb69bb33a2ae41b9"
            })
            console.log('list blocks', blocks.data);

            const reserve = await mit.reserveSheduledAppointment({
                appointmentType: "agendamiento",
                professionalDetails: {
                    specialtyId: "6001fd6deb69bb33a2ae41b9",
                    userId: "611e6f7c92e36c0b6f81fa34",
                    specialtyDetails: {
                        price: 0
                    }
                },
                dateDetails: {
                    date: {
                        year: 2021,
                        month: 8,
                        day: 19
                    },
                    start: "15:30"
                }
            })
            console.log('reserve', reserve.data);

            const consolidate = await mit.consolidateSheduledAppointment([])
            console.log('consolidate', consolidate.data);

            let url = consolidate.data.payload.paymentUrl
            window.open(url)
*/
            } catch (error) {
                console.log(error);
            }
            
        </script>
    </head>
</body>